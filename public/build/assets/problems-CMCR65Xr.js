import{j as e,r as o,a as T,H as z}from"./app-D9XB0GKv.js";import{M as j,a as _,T as p}from"./app-layout-Bo_T2kxO.js";import{A as B,a as L}from"./alert-Bxn1W0Zv.js";import{T as M,a as $,b as d}from"./tabs-q1HzM77d.js";import{C as f,a as D,B as h,b as F,d as I,c as P}from"./badge-CAcXzHsf.js";import{I as E}from"./input-c20-QkMX.js";import{S as H}from"./search-MVjc5ZWV.js";import{B as a}from"./app-logo-icon-DNX6Rdqm.js";import{C as v}from"./clock-C2vpXFrz.js";import{C as U}from"./circle-check-Chdj9J-A.js";import{U as V}from"./user-DHHSAfKA.js";import{M as q}from"./map-pin-BZdtpYzu.js";import{C as G}from"./circle-alert-L-jueXG0.js";/* empty css            */import"./index-BN61bmm7.js";import"./index-Q0z0t_J0.js";import"./createLucideIcon-C6xnCVKw.js";import"./users-C8PTD9Dh.js";function Q({value:s,onChange:n}){return e.jsxs("div",{className:"mb-6 relative flex-1",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(E,{placeholder:"Search by commuter name, bus number, route, or issue...",value:s,onChange:n,className:"pl-10"})]})}function J({report:s}){const n=c=>{switch(c){case"critical":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}},i=c=>{switch(c){case"new":return"default";case"in-progress":return"secondary";case"resolved":return"outline";default:return"outline"}};return e.jsxs(f,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(D,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[e.jsx(h,{variant:n(s.severity),className:"uppercase",children:s.severity}),e.jsxs(h,{variant:i(s.status),children:[s.status==="new"&&e.jsx(j,{className:"h-3 w-3 mr-1"}),s.status==="in-progress"&&e.jsx(v,{className:"h-3 w-3 mr-1"}),s.status==="resolved"&&e.jsx(U,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsx(h,{variant:"outline",children:s.category})]}),e.jsx(F,{className:"text-xl mb-2",children:s.subject}),e.jsx(I,{className:"text-base mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-muted-foreground mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Reported by:"})," ",s.commuterName]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Route:"})," ",s.route]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Bus:"})," ",s.jeepneyDriver]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Incident:"})," ",s.incidentDate]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"})," ",s.commuterContact]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:s.timeAgo})]})]})]})})}),e.jsx(P,{children:e.jsxs("div",{className:"flex gap-2",children:[s.status==="new"&&e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",children:"Assign & Investigate"}),e.jsx(a,{size:"sm",variant:"outline",children:"Contact Commuter"}),e.jsx(a,{size:"sm",variant:"ghost",children:"Mark as Invalid"})]}),s.status==="in-progress"&&e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",children:"Mark as Resolved"}),e.jsx(a,{size:"sm",variant:"outline",children:"Add Update"}),e.jsx(a,{size:"sm",variant:"ghost",children:"View History"})]}),s.status==="resolved"&&e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",variant:"outline",children:"View Resolution"}),e.jsx(a,{size:"sm",variant:"ghost",children:"Reopen"})]})]})})]})}const K=[{title:"Commuter Problems",href:"/problems"}];function he(){const[s,n]=o.useState(""),[i,c]=o.useState([]),[m,N]=o.useState("all");o.useEffect(()=>{T.get("/api/feedback").then(t=>{const x=t.data.map(r=>{const y=r.rating>=4?"high":r.rating===3?"medium":"low",b="new",S=l=>{const R="⭐".repeat(l),k="☆".repeat(5-l);return R+k},A=l=>{switch(l){case 1:return"Poor";case 2:return"Fair";case 3:return"Good";case 4:return"Very Good";case 5:return"Excellent";default:return""}};return{id:r.feedback_id,commuterName:`${r.commuter?.first_name||""} ${r.commuter?.last_name||""}`.trim()||"Unknown",commuterContact:r.commuter?.phone||"N/A",subject:`${S(r.rating)} ${A(r.rating)}`,description:r.comment||"",route:r.ride?.route?`${r.ride.route.first_terminal} - ${r.ride.route.second_terminal}`:"N/A",jeepneyDriver:r.ride?.driver?`${r.ride.driver.first_name} ${r.ride.driver.last_name}`:"N/A",startStop:r.ride?.startStop?.name||"N/A",endStop:r.ride?.endStop?.name||"N/A",incidentDate:new Date(r.created_at).toLocaleString(),severity:y,status:b,category:"Feedback",timeAgo:"Just now"}});c(x)}).catch(t=>{console.error(t)})},[]);const g=(t=>m==="all"?t:t.filter(x=>x.status===m))(i).filter(t=>t.commuterName.toLowerCase().includes(s.toLowerCase())||t.description.toLowerCase().includes(s.toLowerCase())),w=i.filter(t=>t.status==="new").length,u=i.filter(t=>t.severity==="high").length,C=i.filter(t=>t.status==="in-progress").length;return e.jsxs(_,{breadcrumbs:K,children:[e.jsx(z,{title:"Commuter Feedbacks"}),e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"p-2.5 bg-primary rounded-xl",children:e.jsx(j,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx(p,{size:"xl",weight:"bold",children:"Commuter Feedbacks"}),e.jsx(p,{size:"sm",weight:"normal",children:"Manage and review feedback submitted by commuters"})]})]}),u>0&&e.jsxs(B,{variant:"destructive",className:"mb-6",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs(L,{children:[e.jsxs("strong",{children:[u," critical issue",u>1?"s":""]})," requiring immediate attention"]})]}),e.jsx(Q,{value:s,onChange:t=>n(t.target.value)}),e.jsx(M,{value:m,onValueChange:N,className:"mb-6",children:e.jsxs($,{children:[e.jsxs(d,{value:"all",children:["All (",i.length,")"]}),e.jsxs(d,{value:"new",children:["New (",w,")"]}),e.jsxs(d,{value:"in-progress",children:["In Progress (",C,")"]}),e.jsx(d,{value:"resolved",children:"Resolved"})]})}),e.jsxs("div",{className:"space-y-4",children:[g.map(t=>e.jsx(J,{report:t},t.id)),g.length===0&&e.jsxs(f,{className:"text-center py-12",children:[e.jsx(j,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No feedbacks found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters"})]})]})]})]})}export{he as default};
