import{j as e,r as l,a as A,H as z}from"./app-Dwr5nQSL.js";import{a as R,T as j}from"./app-layout-BbVcq0o3.js";import{c as f,f as T,B as n}from"./app-logo-icon-BJBHoFfB.js";import{T as L,a as _,b as o}from"./tabs-BP17bkno.js";import{C as N,a as M,B as x,b as B,d as I,c as F}from"./card-Clo4q2Ds.js";import{I as V}from"./input-CbI6a0oq.js";import{S as D}from"./search-DX3QNRc9.js";import{c as H}from"./createLucideIcon-oDErJY3E.js";import{C as p}from"./clock-Dkoxr6xl.js";import{C as P}from"./circle-check-C2NntYBe.js";import{U}from"./user-BnVVRAV5.js";import{M as q}from"./map-pin-CD8sj7x6.js";import{C as v}from"./circle-alert-BXfASrnC.js";/* empty css            */import"./index-CqDWPltk.js";import"./index-DXZIkiHc.js";import"./users-CmJs16c1.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],w=H("MessageSquare",E),$=T("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}});function Q({className:s,variant:r,...i}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:f($({variant:r}),s),...i})}function J({className:s,...r}){return e.jsx("div",{"data-slot":"alert-description",className:f("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...r})}function G({value:s,onChange:r}){return e.jsxs("div",{className:"mb-6 relative flex-1",children:[e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(V,{placeholder:"Search by commuter name, bus number, route, or issue...",value:s,onChange:r,className:"pl-10"})]})}function K({report:s}){const r=c=>{switch(c){case"critical":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}},i=c=>{switch(c){case"new":return"default";case"in-progress":return"secondary";case"resolved":return"outline";default:return"outline"}};return e.jsxs(N,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(M,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[e.jsx(x,{variant:r(s.severity),className:"uppercase",children:s.severity}),e.jsxs(x,{variant:i(s.status),children:[s.status==="new"&&e.jsx(w,{className:"h-3 w-3 mr-1"}),s.status==="in-progress"&&e.jsx(p,{className:"h-3 w-3 mr-1"}),s.status==="resolved"&&e.jsx(P,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsx(x,{variant:"outline",children:s.category})]}),e.jsx(B,{className:"text-xl mb-2",children:s.subject}),e.jsx(I,{className:"text-base mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-muted-foreground mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Reported by:"})," ",s.commuterName]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Route:"})," ",s.route]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Bus:"})," ",s.busNumber]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Incident:"})," ",s.incidentDate]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"})," ",s.commuterContact]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx("span",{children:s.timeAgo})]})]})]})})}),e.jsx(F,{children:e.jsxs("div",{className:"flex gap-2",children:[s.status==="new"&&e.jsxs(e.Fragment,{children:[e.jsx(n,{size:"sm",children:"Assign & Investigate"}),e.jsx(n,{size:"sm",variant:"outline",children:"Contact Commuter"}),e.jsx(n,{size:"sm",variant:"ghost",children:"Mark as Invalid"})]}),s.status==="in-progress"&&e.jsxs(e.Fragment,{children:[e.jsx(n,{size:"sm",children:"Mark as Resolved"}),e.jsx(n,{size:"sm",variant:"outline",children:"Add Update"}),e.jsx(n,{size:"sm",variant:"ghost",children:"View History"})]}),s.status==="resolved"&&e.jsxs(e.Fragment,{children:[e.jsx(n,{size:"sm",variant:"outline",children:"View Resolution"}),e.jsx(n,{size:"sm",variant:"ghost",children:"Reopen"})]})]})})]})}const O=[{title:"Commuter Problems",href:"/problems"}];function ge(){const[s,r]=l.useState(""),[i,c]=l.useState([]),[d,b]=l.useState("all"),[C,h]=l.useState(!0);l.useEffect(()=>{A.get("/api/feedback").then(t=>{h(!1);const u=t.data.map(a=>{const k=a.rating>=4?"high":a.rating===3?"medium":"low";return{id:a.feedback_id,commuterName:`${a.commuter?.first_name||""} ${a.commuter?.last_name||""}`.trim()||"Unknown",commuterContact:a.commuter?.phone||"N/A",subject:`Rating: ${a.rating}/5`,description:a.comment||"",route:a.ride?.route?.name||"N/A",startStop:a.ride?.startStop?.name||"N/A",endStop:a.ride?.endStop?.name||"N/A",incidentDate:new Date(a.created_at).toLocaleString(),severity:k,status:"new",category:"Feedback",timeAgo:"Just now"}});c(u)}).catch(t=>{console.error(t),h(!1)})},[]);const g=(t=>d==="all"?t:t.filter(u=>u.status===d))(i).filter(t=>t.commuterName.toLowerCase().includes(s.toLowerCase())||t.description.toLowerCase().includes(s.toLowerCase())),y=i.filter(t=>t.status==="new").length,m=i.filter(t=>t.severity==="high").length,S=i.filter(t=>t.status==="in-progress").length;return C?e.jsx("p",{className:"text-center py-12",children:"Loading feedbacks..."}):e.jsxs(R,{breadcrumbs:O,children:[e.jsx(z,{title:"Commuter Feedbacks"}),e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"p-2.5 bg-primary rounded-xl",children:e.jsx(v,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx(j,{size:"xl",weight:"bold",children:"Commuter Feedbacks"}),e.jsx(j,{size:"sm",weight:"normal",children:"Manage and review feedback submitted by commuters"})]})]}),m>0&&e.jsxs(Q,{variant:"destructive",className:"mb-6",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsxs(J,{children:[e.jsxs("strong",{children:[m," critical issue",m>1?"s":""]})," requiring immediate attention"]})]}),e.jsx(G,{value:s,onChange:t=>r(t.target.value)}),e.jsx(L,{value:d,onValueChange:b,className:"mb-6",children:e.jsxs(_,{children:[e.jsxs(o,{value:"all",children:["All (",i.length,")"]}),e.jsxs(o,{value:"new",children:["New (",y,")"]}),e.jsxs(o,{value:"in-progress",children:["In Progress (",S,")"]}),e.jsx(o,{value:"resolved",children:"Resolved"})]})}),e.jsxs("div",{className:"space-y-4",children:[g.map(t=>e.jsx(K,{report:t},t.id)),g.length===0&&e.jsxs(N,{className:"text-center py-12",children:[e.jsx(w,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No feedbacks found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters"})]})]})]})]})}export{ge as default};
