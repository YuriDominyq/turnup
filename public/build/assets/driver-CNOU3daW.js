import{r as m,j as e,a as k,H as Ae}from"./app-d9SgxdQS.js";import{g as U,R as Ce,h as Pe,P as De,W as Se,C as _e,i as Re,j as ke,k as q,O as Ee,e as Me,l as Fe,f as Le,y as E,X as Te,A as $e,T as O}from"./app-layout-LWcGx1ZE.js";import{C as G,a as H,b as J,d as Be,c as V,B as ze}from"./card-DYwXZ9vT.js";import{u as W,b as Ie,c as D,d as Y,B as N}from"./app-logo-icon-CPYCTx_O.js";import{c as Oe,a as Ue}from"./index-BkHP6GWz.js";import{U as Z}from"./users-Pwk57gk4.js";import{M as qe}from"./mail-CfyJbIGD.js";import{c as _}from"./createLucideIcon-C3SxUK1l.js";import{M as Ge}from"./map-pin-BJKHSU_Q.js";import{E as He,T as Je}from"./trash-2-CxmYNVhc.js";import{S as Ve}from"./square-pen-B6sqoFRt.js";import{I as w}from"./input-uMQZdMB5.js";import{S as T,a as $,b as B,c as z,d as A}from"./select-Cj0G3FOf.js";import{S as We}from"./search-BWMxfgXu.js";import{F as Ye,D as Ze}from"./filter-CFAJXR20.js";import{D as Qe,e as Ke,a as Xe,b as es,c as ss,f as as}from"./dialog-BmHxW5Ji.js";import{L as b}from"./label-Xfo8vVzI.js";import{U as ts}from"./user-BIg3jQbs.js";import{C as v}from"./circle-alert-BtFyji7p.js";import{C as rs}from"./car-B11Rq-Ef.js";import{U as ls}from"./upload-37wyz632.js";import{P as ns}from"./plus-Bkc80N5v.js";import{C as is}from"./clock-UGBvxiyS.js";/* empty css            */import"./index-BvyCzCKY.js";import"./index-eFwUsKV_.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],cs=_("ArrowLeft",os);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ms=_("ArrowRight",ds);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],I=_("CircleCheckBig",ps);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],xs=_("FileText",hs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],fs=_("Phone",us);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],js=_("Star",gs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],vs=_("UserCheck",Ns);var Q="AlertDialog",[ys,ga]=Oe(Q,[U]),C=U(),K=a=>{const{__scopeAlertDialog:r,...s}=a,l=C(r);return e.jsx(Ce,{...l,...s,modal:!0})};K.displayName=Q;var ws="AlertDialogTrigger",X=m.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...l}=a,n=C(s);return e.jsx(Pe,{...n,...l,ref:r})});X.displayName=ws;var bs="AlertDialogPortal",ee=a=>{const{__scopeAlertDialog:r,...s}=a,l=C(r);return e.jsx(De,{...l,...s})};ee.displayName=bs;var As="AlertDialogOverlay",se=m.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...l}=a,n=C(s);return e.jsx(Ee,{...n,...l,ref:r})});se.displayName=As;var R="AlertDialogContent",[Cs,Ps]=ys(R),Ds=Ie("AlertDialogContent"),ae=m.forwardRef((a,r)=>{const{__scopeAlertDialog:s,children:l,...n}=a,d=C(s),i=m.useRef(null),x=W(r,i),f=m.useRef(null);return e.jsx(Se,{contentName:R,titleName:te,docsSlug:"alert-dialog",children:e.jsx(Cs,{scope:s,cancelRef:f,children:e.jsxs(_e,{role:"alertdialog",...d,...n,ref:x,onOpenAutoFocus:Ue(n.onOpenAutoFocus,c=>{c.preventDefault(),f.current?.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[e.jsx(Ds,{children:l}),e.jsx(_s,{contentRef:i})]})})})});ae.displayName=R;var te="AlertDialogTitle",re=m.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...l}=a,n=C(s);return e.jsx(Re,{...n,...l,ref:r})});re.displayName=te;var le="AlertDialogDescription",ne=m.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...l}=a,n=C(s);return e.jsx(ke,{...n,...l,ref:r})});ne.displayName=le;var Ss="AlertDialogAction",ie=m.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...l}=a,n=C(s);return e.jsx(q,{...n,...l,ref:r})});ie.displayName=Ss;var oe="AlertDialogCancel",ce=m.forwardRef((a,r)=>{const{__scopeAlertDialog:s,...l}=a,{cancelRef:n}=Ps(oe,s),d=C(s),i=W(r,n);return e.jsx(q,{...d,...l,ref:i})});ce.displayName=oe;var _s=({contentRef:a})=>{const r=`\`${R}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${R}\` by passing a \`${le}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${R}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return m.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(r)},[r,a]),null},Rs=K,ks=X,Es=ee,de=se,me=ae,pe=ie,he=ce,xe=re,ue=ne;const Ms=Rs,Fs=ks,Ls=Es,fe=m.forwardRef(({className:a,...r},s)=>e.jsx(de,{className:D("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:s}));fe.displayName=de.displayName;const ge=m.forwardRef(({className:a,...r},s)=>e.jsxs(Ls,{children:[e.jsx(fe,{}),e.jsx(me,{ref:s,className:D("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]}));ge.displayName=me.displayName;const je=({className:a,...r})=>e.jsx("div",{className:D("flex flex-col space-y-2 text-center sm:text-left",a),...r});je.displayName="AlertDialogHeader";const Ne=({className:a,...r})=>e.jsx("div",{className:D("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...r});Ne.displayName="AlertDialogFooter";const ve=m.forwardRef(({className:a,...r},s)=>e.jsx(xe,{ref:s,className:D("text-lg font-semibold",a),...r}));ve.displayName=xe.displayName;const ye=m.forwardRef(({className:a,...r},s)=>e.jsx(ue,{ref:s,className:D("text-sm text-muted-foreground",a),...r}));ye.displayName=ue.displayName;const we=m.forwardRef(({className:a,...r},s)=>e.jsx(pe,{ref:s,className:D(Y(),a),...r}));we.displayName=pe.displayName;const be=m.forwardRef(({className:a,...r},s)=>e.jsx(he,{ref:s,className:D(Y({variant:"outline"}),"mt-2 sm:mt-0",a),...r}));be.displayName=he.displayName;const Ts=(a,r)=>`${a?.charAt(0)||""}${r?.charAt(0)||""}`.toUpperCase();function $s({filteredDrivers:a,getStatusBadge:r,onUpdateDriver:s}){const l=async i=>{try{await k.delete(`/operator/driver/${i}`),s({drivers_id:i}),E.success("Delete Driver Successfully")}catch(x){console.error("Failed to delete driver",x)}},n=async i=>{try{const x=await k.post(`/operator/driver/${i}/approve`);s(x.data.driver),E.success("Approve Driver Successfully")}catch(x){console.error("Failed to approve driver",x)}},d=async i=>{try{const x=await k.post(`/operator/driver/${i}/reject`);s(x.data.driver),E.success("Reject Driver Successfully")}catch(x){console.error("Failed to reject driver",x)}};return a.length===0?e.jsxs("div",{className:"p-12 text-center text-muted-foreground",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No drivers found matching your search or filter"})]}):e.jsxs(G,{children:[e.jsxs(H,{children:[e.jsxs(J,{children:["Jeepney Drivers (",a.length,")"]}),e.jsx(Be,{children:"Manage modernized jeepney drivers and route assignments"})]}),e.jsx(V,{children:e.jsx("div",{className:"space-y-4",children:a.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(Me,{className:"h-12 w-12",children:[e.jsx(Fe,{src:i.avatar_url}),e.jsx(Le,{className:"bg-primary text-primary-foreground",children:Ts(i.first_name,i.last_name)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"font-semibold",children:[i.first_name," ",i.last_name]}),e.jsx(ze,{className:r(i.status).color,children:i.status})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(qe,{className:"h-3 w-3"}),i.email]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(fs,{className:"h-3 w-3"}),i.phone]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ge,{className:"h-3 w-3"}),i.route?.first_terminal," ↔ ",i.route?.second_terminal]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm font-medium",children:i.license_plate})}),i.status==="active"&&e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(js,{className:"h-3 w-3 text-yellow-500"}),e.jsx("span",{className:"text-sm font-medium",children:i.rating})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[i.total_trips," trips"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{variant:"ghost",size:"sm",children:e.jsx(He,{className:"h-4 w-4"})}),e.jsx(N,{variant:"ghost",size:"sm",children:e.jsx(Ve,{className:"h-4 w-4"})}),e.jsxs(Ms,{children:[e.jsx(Fs,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",children:e.jsx(Je,{className:"h-4 w-4"})})}),e.jsxs(ge,{children:[e.jsxs(je,{children:[e.jsx(ve,{children:"Delete Driver Account"}),e.jsxs(ye,{children:["Are you sure you want to delete ",i.first_name," ",i.last_name,"'s account? This action cannot be undone."]})]}),e.jsxs(Ne,{children:[e.jsx(be,{children:"Cancel"}),e.jsx(we,{onClick:()=>l(i.drivers_id),children:"Delete"})]})]})]}),i.status==="pending"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"default",size:"sm",onClick:()=>n(i.drivers_id),children:"Approve"}),e.jsx(N,{variant:"destructive",size:"sm",onClick:()=>d(i.drivers_id),children:"Reject"})]})]})]})]},i.drivers_id))})})]})}function Bs({searchQuery:a,setSearchQuery:r,selectedStatus:s,setSelectedStatus:l,onExport:n}){return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(We,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(w,{placeholder:"Search drivers by name, route, or terminal...",value:a,onChange:d=>r(d.target.value),className:"pl-10"})]}),e.jsxs(T,{value:s,onValueChange:l,children:[e.jsxs($,{className:"w-48",children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),e.jsx(B,{})]}),e.jsxs(z,{children:[e.jsx(A,{value:"all",children:"All Status"}),e.jsx(A,{value:"active",children:"Active"}),e.jsx(A,{value:"pending",children:"Pending"}),e.jsx(A,{value:"suspended",children:"Suspended"}),e.jsx(A,{value:"inactive",children:"Inactive"})]})]}),e.jsxs(N,{variant:"outline",onClick:n,children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Export"]})]})}function F({title:a,icon:r,count:s,description:l}){return e.jsxs(G,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(J,{className:"text-sm font-medium",children:a}),r]}),e.jsxs(V,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l})]})]})}const zs=({currentStep:a,totalSteps:r})=>e.jsx("div",{className:"flex items-center justify-center mb-6",children:Array.from({length:r},(s,l)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${l<=a?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:l+1}),l<r-1&&e.jsx("div",{className:`w-12 h-0.5 mx-2 ${l<a?"bg-primary":"bg-muted"}`})]},l))}),Is=({newDriver:a,setNewDriver:r})=>{const[s,l]=m.useState({}),[n,d]=m.useState({}),i=(c,u)=>{let h="";switch(c){case"firstName":u.trim()?u.trim().length<2&&(h="Name must be at least 2 characters"):h="First name is required";break;case"lastName":u.trim()?u.trim().length<2&&(h="Name must be at least 2 characters"):h="Last name is required";break;case"email":u.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)||(h="Please enter a valid email address"):h="Email is required";break;case"phone":u.trim()?/^(\+63|0)?[0-9]{10}$/.test(u.replace(/\s+/g,""))||(h="Please enter a valid Philippine phone number"):h="Phone number is required";break;case"password":u?u.length<8?h="Password must be at least 8 characters":/(?=.*[a-zA-Z])(?=.*[0-9])/.test(u)||(h="Password must contain both letters and numbers"):h="Password is required";break;case"confirmPassword":u?u!==a.password&&(h="Passwords do not match"):h="Please confirm your password";break}return h},x=c=>{d({...n,[c]:!0});const u=i(c,a[c]);l({...s,[c]:u})},f=(c,u)=>{if(r({...a,[c]:u}),n[c]){const h=i(c,u);l({...s,[c]:h})}if(c==="password"&&n.confirmPassword){const h=i("confirmPassword",a.confirmPassword);l({...s,[c]:"",confirmPassword:h})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ts,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Personal Information"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"firstName",children:"First Name *"}),e.jsx(w,{id:"firstName",value:a.firstName,onChange:c=>f("firstName",c.target.value),onBlur:()=>x("firstName"),placeholder:"Enter first name",className:s.firstName&&n.firstName?"border-red-500 focus-visible:ring-red-500":""}),s.firstName&&n.firstName&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.firstName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(w,{id:"lastName",value:a.lastName,onChange:c=>f("lastName",c.target.value),onBlur:()=>x("lastName"),placeholder:"Enter last name",className:s.lastName&&n.lastName?"border-red-500 focus-visible:ring-red-500":""}),s.lastName&&n.lastName&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.lastName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"email",children:"Email Address *"}),e.jsx(w,{id:"email",type:"email",value:a.email,onChange:c=>f("email",c.target.value),onBlur:()=>x("email"),placeholder:"Enter email address",className:s.email&&n.email?"border-red-500 focus-visible:ring-red-500":""}),s.email&&n.email&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.email})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(w,{id:"phone",value:a.phone,onChange:c=>f("phone",c.target.value),onBlur:()=>x("phone"),placeholder:"+63 917 123 4567",className:s.phone&&n.phone?"border-red-500 focus-visible:ring-red-500":""}),s.phone&&n.phone&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.phone})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"password",children:"Password *"}),e.jsx(w,{id:"password",type:"password",value:a.password,onChange:c=>f("password",c.target.value),onBlur:()=>x("password"),placeholder:"Create password",className:s.password&&n.password?"border-red-500 focus-visible:ring-red-500":""}),s.password&&n.password?e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.password})]}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Min. 8 characters with letters and numbers"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"confirmPassword",children:"Confirm Password *"}),e.jsx(w,{id:"confirmPassword",type:"password",value:a.confirmPassword,onChange:c=>f("confirmPassword",c.target.value),onBlur:()=>x("confirmPassword"),placeholder:"Confirm password",className:s.confirmPassword&&n.confirmPassword?"border-red-500 focus-visible:ring-red-500":""}),s.confirmPassword&&n.confirmPassword&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.confirmPassword})]})]})]})},Os=({newDriver:a,setNewDriver:r})=>{const[s,l]=m.useState({}),[n,d]=m.useState({}),[i,x]=m.useState([]);m.useEffect(()=>{k.get("/routes").then(t=>x(t.data)).catch(t=>console.error(t))},[]);const f=(t,o)=>{let p="";switch(t){case"vehicleType":(!o||o.trim()==="")&&(p="Please select a jeepney type.");break;case"licensePlate":o.trim()?/^[A-Z]{2,3}-?\d{3,4}$/i.test(o.replace(/\s+/g,""))||(p="Invalid license plate format."):p="License plate is required.";break;case"route":(!o||o.trim()==="")&&(p="Please select a route assignment.");break}return p},c=t=>{d({...n,[t]:!0});const o=f(t,a[t]);l({...s,[t]:o})},u=(t,o)=>{if(r({...a,[t]:o}),n[t]){const p=f(t,o);l({...s,[t]:p})}},h=(t,o)=>{r({...a,[t]:o}),d({...n,[t]:!0});const p=f(t,o);l({...s,[t]:p})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(rs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle & Route Details"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"vehicleType",children:"Jeepney Type *"}),e.jsxs(T,{value:a.vehicleType,onValueChange:t=>h("vehicleType",t),children:[e.jsx($,{className:s.vehicleType&&n.vehicleType?"border-red-500 focus:ring-red-500":"",children:e.jsx(B,{placeholder:"Select jeepney type"})}),e.jsxs(z,{children:[e.jsx(A,{value:"modern-jeepney",children:"Modern Jeepney (Electric)"}),e.jsx(A,{value:"euro4-jeepney",children:"Euro 4 Jeepney"}),e.jsx(A,{value:"mini-bus",children:"Mini Bus"})]})]}),s.vehicleType&&n.vehicleType&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.vehicleType})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"licensePlate",children:"License Plate *"}),e.jsx(w,{id:"licensePlate",value:a.licensePlate,onChange:t=>u("licensePlate",t.target.value.toUpperCase()),onBlur:()=>c("licensePlate"),placeholder:"BAC-1234",maxLength:8,className:s.licensePlate&&n.licensePlate?"border-red-500 focus-visible:ring-red-500":""}),s.licensePlate&&n.licensePlate&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.licensePlate})]}),!s.licensePlate&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: ABC-1234 or AB-1234"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"route",children:"Assigned Route *"}),e.jsxs(T,{value:a.route,onValueChange:t=>h("route",t),children:[e.jsx($,{className:s.route&&n.route?"border-red-500 focus:ring-red-500":"",children:e.jsx(B,{placeholder:"Select route assignment"})}),e.jsx(z,{children:i.map(t=>e.jsxs(A,{value:t.id.toString(),children:[t.first_terminal," ↔ ",t.second_terminal]},t.id))})]}),s.route&&n.route&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(v,{className:"h-3 w-3"}),e.jsx("span",{children:s.route})]})]})]})},Us=({newDriver:a,setNewDriver:r})=>{const[s,l]=m.useState({}),[n,d]=m.useState({}),i=m.useRef(null),x=m.useRef(null),f=m.useRef(null),c=m.useRef(null),u=p=>["application/pdf","image/jpg","image/jpeg","image/png"].includes(p.type)?p.size>5242880?"File size exceeds the maximum limit of 5MB. Please upload a smaller file.":null:"Invalid file type. Only PDF, JPG, PNG are allowed.",h=(p,g)=>{if(!g)return;const j=u(g);if(j){d({...n,[p]:j});return}const y={...n};delete y[p],d(y);let P;g.type.startsWith("image/")&&(P=URL.createObjectURL(g)),l({...s,[p]:{file:g,preview:P}}),r({...a,documents:{...a.documents,[p]:g}})},t=p=>{const g={...s};g[p]?.preview&&URL.revokeObjectURL(g[p].preview),delete g[p],l(g);const j={...n};delete j[p],d(j);const y={...a.documents};delete y[p],r({...a,documents:y})},o=(p,g,j,y)=>{const P=s[j],S=n[j],M=!!P&&!S;return e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{ref:y,type:"file",accept:".pdf, .jpg, .jpeg, .png",className:"hidden",onChange:L=>h(j,L.target.files?.[0]||null)}),e.jsxs(N,{type:"button",variant:"outline",className:`h-16 w-full flex items-center justify-between gap-3 ${M?"border-green-500 bg-green-50":S?"border-red-500 bg-red-50":""}`,onClick:()=>y.current?.click(),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[M?e.jsx(I,{className:"h-5 w-5 text-green-600"}):S?e.jsx(v,{className:"h-5 w-5 text-red-600"}):e.jsx(ls,{className:"h-5 w-5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:p}),e.jsx("div",{className:"text-xs text-muted-foreground",children:g})]})]}),M&&e.jsx(N,{type:"button",variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:L=>{L.stopPropagation(),t(j)},children:e.jsx(Te,{className:"h-4 w-4"})})]}),M&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 pl-2",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:P?.file.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",(P.file.size/1024).toFixed(0)," KB)"]})]}),S&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 pl-2",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:S})]})]})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Required Documents"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload the required documents. You can also upload these later from the driver profile."}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[o("Professional Driver's License","PDF, JPG, PNG (Max 5MB)","driverLicense",i),o("Vehicle Registration (CR/OR)","PDF, JPG, PNG (Max 5MB)","vehicleRegistration",x),o("TPL Insurance","PDF, JPG, PNG (Max 5MB)","insurance",f),o("Franchise Certificate","PDF, JPG, PNG (Max 5MB)","franchise",c)]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," All documents are optional at this stage. You can upload them later, but having complete documentation helps speed up the approval process."]})})]})},qs=({onCreateDriver:a})=>{const[r,s]=m.useState(!1),[l,n]=m.useState(0),[d,i]=m.useState({firstName:"",lastName:"",email:"",phone:"",password:"",confirmPassword:"",vehicleType:"",licensePlate:"",route:""}),x=async t=>{try{const o=new FormData;o.append("first_name",t.firstName),o.append("last_name",t.lastName),o.append("email",t.email),o.append("phone",t.phone),o.append("password",t.password),o.append("password_confirmation",t.confirmPassword),o.append("vehicle_type",t.vehicleType),o.append("license_plate",t.licensePlate),o.append("route_id",t.route),t.documents?.driverLicense&&o.append("driver_license",t.documents.driverLicense),t.documents?.vehicleRegistration&&o.append("vehicle_registration",t.documents.vehicleRegistration),t.documents?.insurance&&o.append("insurance",t.documents.insurance),t.documents?.franchise&&o.append("franchise",t.documents.franchise),await k.post("/operator/driver",o,{headers:{"Content-Type":"multipart/form-data"}}),E.success("Driver Creation Successfully"),a(t),s(!1),n(0)}catch(o){console.error(o),E.error("Error Driver Creation")}},f=()=>{l<2&&n(l+1)},c=()=>{l>0&&n(l-1)},u=t=>{switch(t){case 0:return d.firstName&&d.lastName&&d.email&&d.phone&&d.password&&d.confirmPassword;case 1:return d.vehicleType&&d.licensePlate&&d.route;case 2:return!0;default:return!1}},h=()=>{switch(l){case 0:return e.jsx(Is,{newDriver:d,setNewDriver:i});case 1:return e.jsx(Os,{newDriver:d,setNewDriver:i});case 2:return e.jsx(Us,{newDriver:d,setNewDriver:i});default:return null}};return e.jsxs(Qe,{open:r,onOpenChange:s,children:[e.jsx(Ke,{asChild:!0,children:e.jsxs(N,{children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Add New Driver"]})}),e.jsxs(Xe,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(es,{children:[e.jsx(ss,{children:"Register New Jeepney Driver"}),e.jsx(as,{children:"Complete the registration process in 3 simple steps"})]}),e.jsx(zs,{currentStep:l,totalSteps:3}),h(),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("div",{children:l>0&&e.jsxs(N,{variant:"outline",onClick:c,children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Previous"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),l<2?e.jsxs(N,{onClick:f,disabled:!u(l),children:["Next",e.jsx(ms,{className:"h-4 w-4 ml-2"})]}):e.jsx(N,{onClick:()=>x(d),children:"Register Driver"})]})]})]})]})},Gs=[{title:"Driver",href:"/driver"}];function ja({drivers:a}){const[r,s]=m.useState(a),[l,n]=m.useState(""),[d,i]=m.useState("all"),x=t=>{const o={active:{variant:"default",color:"bg-green-100 text-green-800"},pending:{variant:"secondary",color:"bg-yellow-100 text-yellow-800"},suspended:{variant:"destructive",color:"bg-red-100 text-red-800"},inactive:{variant:"outline",color:"bg-gray-100 text-gray-800"}};return o[t]||o.inactive},f=t=>{console.log("Create Driver",t)},c=()=>{console.log("Exporting drivers")},u=t=>{t&&(t.deleted?s(o=>o.filter(p=>p.drivers_id!==t.drivers_id)):s(o=>o.map(p=>p.drivers_id===t.drivers_id?t:p)))},h=r.filter(t=>{const o=t.first_name??"",p=t.last_name??"",g=t.email??"",j=t.phone??"",y=(t.status??"").toLowerCase(),P=o.toLowerCase().includes(l.toLowerCase())||p.toLowerCase().includes(l.toLowerCase())||g.toLowerCase().includes(l.toLowerCase())||j.includes(l),S=d==="all"||y===d.toLowerCase();return P&&S});return e.jsxs($e,{breadcrumbs:Gs,children:[e.jsx(Ae,{title:"Driver Management"}),e.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-primary rounded-xl",children:e.jsx(Z,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx(O,{size:"xl",weight:"bold",children:"Modern Jeepney Driver Management"}),e.jsx(O,{size:"sm",weight:"normal",children:"Manage modernized jeepney drivers in Bacolod City"})]})]}),e.jsx(qs,{onCreateDriver:f})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(F,{title:"Total Jeepney Drivers",icon:e.jsx(vs,{className:"h-4 w-4 text-muted-foreground"}),count:a.length,description:"+2 this week"}),e.jsx(F,{title:"Active on Routes",icon:e.jsx(I,{className:"h-4 w-4 text-green-500"}),count:a.filter(t=>t.status==="active").length,description:"Operating Routes"}),e.jsx(F,{title:"Pending Approval",icon:e.jsx(is,{className:"h-4 w-4 text-yellow-500"}),count:a.filter(t=>t.status==="pending").length,description:"Awaiting verification"}),e.jsx(F,{title:"Issues",icon:e.jsx(v,{className:"h-4 w-4 text-red-400"}),count:a.filter(t=>t.status==="suspended").length,description:"Need Attention"})]}),e.jsx(Bs,{searchQuery:l,setSearchQuery:n,selectedStatus:d,setSelectedStatus:i,onExport:c}),e.jsx($s,{filteredDrivers:h,getStatusBadge:x,onUpdateDriver:u})]})]})}export{ja as default};
