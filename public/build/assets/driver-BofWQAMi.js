import{r as u,j as e,a as R,c as F,H as Se}from"./app-DiEPR3Ow.js";import{e as J,R as _e,f as Re,P as Ee,W as ke,C as Le,g as Fe,D as Te,h as V,O as Me,b as Be,d as Oe,c as $e,y as E,X as Ie,a as Ue,T as G}from"./app-layout-Djywz-Bl.js";import{B as ze}from"./badge-D6njXIlB.js";import{C as W,a as Y,b as X,d as qe,c as K}from"./card-DmWYg7a-.js";import{u as Q,b as Ge,c as S,d as Z,B as y}from"./app-logo-icon-ROwsYhCQ.js";import{c as He,a as Je}from"./index-D2bGUScE.js";import{U as ee}from"./users-DdzEtUM0.js";import{M as Ve}from"./mail-BrvunPal.js";import{P as We}from"./phone-7_yq_ttx.js";import{M as Ye}from"./map-pin-27niUzD7.js";import{S as Xe,u as O,w as Ke}from"./xlsx-DDs82Vb9.js";import{E as Qe}from"./eye-BGvi-Kpr.js";import{c as k}from"./createLucideIcon-CgVv4oVW.js";import{T as Ze}from"./trash-2-B-hEnkcy.js";import{I as A}from"./input-BrmnvxHa.js";import{S as $,a as I,b as U,c as z,d as D}from"./select-BRNZEcqh.js";import{S as es}from"./search-DGammELY.js";import{a as ss,F as ts}from"./filter-HPs1DfHV.js";import{D as as}from"./download-ROVPd9vK.js";import{D as rs,e as ns,a as os,b as ls,c as is,f as cs}from"./dialog-DBCVIktz.js";import{L as C}from"./label-YrZJlUuD.js";import{U as ds}from"./user-C6wsjox2.js";import{C as b}from"./circle-alert-QXcJFZlA.js";import{C as ms}from"./car-BcElRxk1.js";import{U as ps}from"./upload-S9bDq1Ld.js";import{P as hs}from"./plus-YW-qto5o.js";import{C as us}from"./clock-DJvZVmlM.js";/* empty css            */import"./index-e5y4oqqf.js";import"./index-BdQq_4o_.js";import"./index-C-GfuNe5.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],fs=k("ArrowLeft",xs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],js=k("ArrowRight",gs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],q=k("CircleCheckBig",vs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ys=k("SquarePen",Ns);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],bs=k("UserCheck",ws);var se="AlertDialog",[As,St]=He(se,[J]),P=J(),te=a=>{const{__scopeAlertDialog:n,...t}=a,o=P(n);return e.jsx(_e,{...o,...t,modal:!0})};te.displayName=se;var Cs="AlertDialogTrigger",ae=u.forwardRef((a,n)=>{const{__scopeAlertDialog:t,...o}=a,i=P(t);return e.jsx(Re,{...i,...o,ref:n})});ae.displayName=Cs;var Ds="AlertDialogPortal",re=a=>{const{__scopeAlertDialog:n,...t}=a,o=P(n);return e.jsx(Ee,{...o,...t})};re.displayName=Ds;var Ps="AlertDialogOverlay",ne=u.forwardRef((a,n)=>{const{__scopeAlertDialog:t,...o}=a,i=P(t);return e.jsx(Me,{...i,...o,ref:n})});ne.displayName=Ps;var _="AlertDialogContent",[Ss,_s]=As(_),Rs=Ge("AlertDialogContent"),oe=u.forwardRef((a,n)=>{const{__scopeAlertDialog:t,children:o,...i}=a,m=P(t),c=u.useRef(null),x=Q(n,c),g=u.useRef(null);return e.jsx(ke,{contentName:_,titleName:le,docsSlug:"alert-dialog",children:e.jsx(Ss,{scope:t,cancelRef:g,children:e.jsxs(Le,{role:"alertdialog",...m,...i,ref:x,onOpenAutoFocus:Je(i.onOpenAutoFocus,r=>{r.preventDefault(),g.current?.focus({preventScroll:!0})}),onPointerDownOutside:r=>r.preventDefault(),onInteractOutside:r=>r.preventDefault(),children:[e.jsx(Rs,{children:o}),e.jsx(ks,{contentRef:c})]})})})});oe.displayName=_;var le="AlertDialogTitle",ie=u.forwardRef((a,n)=>{const{__scopeAlertDialog:t,...o}=a,i=P(t);return e.jsx(Fe,{...i,...o,ref:n})});ie.displayName=le;var ce="AlertDialogDescription",de=u.forwardRef((a,n)=>{const{__scopeAlertDialog:t,...o}=a,i=P(t);return e.jsx(Te,{...i,...o,ref:n})});de.displayName=ce;var Es="AlertDialogAction",me=u.forwardRef((a,n)=>{const{__scopeAlertDialog:t,...o}=a,i=P(t);return e.jsx(V,{...i,...o,ref:n})});me.displayName=Es;var pe="AlertDialogCancel",he=u.forwardRef((a,n)=>{const{__scopeAlertDialog:t,...o}=a,{cancelRef:i}=_s(pe,t),m=P(t),c=Q(n,i);return e.jsx(V,{...m,...o,ref:c})});he.displayName=pe;var ks=({contentRef:a})=>{const n=`\`${_}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${_}\` by passing a \`${ce}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${_}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return u.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(n)},[n,a]),null},Ls=te,Fs=ae,Ts=re,ue=ne,xe=oe,fe=me,ge=he,je=ie,ve=de;const Ms=Ls,Bs=Fs,Os=Ts,Ne=u.forwardRef(({className:a,...n},t)=>e.jsx(ue,{className:S("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n,ref:t}));Ne.displayName=ue.displayName;const ye=u.forwardRef(({className:a,...n},t)=>e.jsxs(Os,{children:[e.jsx(Ne,{}),e.jsx(xe,{ref:t,className:S("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n})]}));ye.displayName=xe.displayName;const we=({className:a,...n})=>e.jsx("div",{className:S("flex flex-col space-y-2 text-center sm:text-left",a),...n});we.displayName="AlertDialogHeader";const be=({className:a,...n})=>e.jsx("div",{className:S("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...n});be.displayName="AlertDialogFooter";const Ae=u.forwardRef(({className:a,...n},t)=>e.jsx(je,{ref:t,className:S("text-lg font-semibold",a),...n}));Ae.displayName=je.displayName;const Ce=u.forwardRef(({className:a,...n},t)=>e.jsx(ve,{ref:t,className:S("text-sm text-muted-foreground",a),...n}));Ce.displayName=ve.displayName;const De=u.forwardRef(({className:a,...n},t)=>e.jsx(fe,{ref:t,className:S(Z(),a),...n}));De.displayName=fe.displayName;const Pe=u.forwardRef(({className:a,...n},t)=>e.jsx(ge,{ref:t,className:S(Z({variant:"outline"}),"mt-2 sm:mt-0",a),...n}));Pe.displayName=ge.displayName;const $s=(a,n)=>`${a?.charAt(0)||""}${n?.charAt(0)||""}`.toUpperCase();function Is({filteredDrivers:a,getStatusBadge:n,onUpdateDriver:t}){const o=async c=>{try{await R.delete(`/operator/driver/${c}`),t({drivers_id:c}),E.success("Delete Driver Successfully")}catch(x){console.error("Failed to delete driver",x)}},i=async c=>{try{const x=await R.post(`/operator/driver/${c}/approve`);t(x.data.driver),E.success("Approve Driver Successfully")}catch(x){console.error("Failed to approve driver",x)}},m=async c=>{try{const x=await R.post(`/operator/driver/${c}/reject`);t(x.data.driver),E.success("Reject Driver Successfully")}catch(x){console.error("Failed to reject driver",x)}};return a.length===0?e.jsxs("div",{className:"p-12 text-center text-muted-foreground",children:[e.jsx(ee,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No drivers found matching your search or filter"})]}):e.jsxs(W,{children:[e.jsxs(Y,{children:[e.jsxs(X,{children:["Jeepney Drivers (",a.length,")"]}),e.jsx(qe,{children:"Manage modernized jeepney drivers and route assignments"})]}),e.jsx(K,{children:e.jsx("div",{className:"space-y-4",children:a.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(Be,{className:"h-12 w-12",children:[e.jsx(Oe,{src:c.avatar_url}),e.jsx($e,{className:"bg-primary text-primary-foreground",children:$s(c.first_name,c.last_name)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"font-semibold",children:[c.first_name," ",c.last_name]}),e.jsx(ze,{className:n(c.status).color,children:c.status})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"}),c.email]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(We,{className:"h-3 w-3"}),c.phone]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"h-3 w-3"}),c.route?.first_terminal," ↔ ",c.route?.second_terminal]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm font-medium",children:c.license_plate})}),c.status==="active"&&e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xe,{className:"h-3 w-3 text-yellow-500"}),e.jsx("span",{className:"text-sm font-medium",children:c.rating})]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(ys,{className:"h-4 w-4"})}),e.jsxs(Ms,{children:[e.jsx(Bs,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(Ze,{className:"h-4 w-4"})})}),e.jsxs(ye,{children:[e.jsxs(we,{children:[e.jsx(Ae,{children:"Delete Driver Account"}),e.jsxs(Ce,{children:["Are you sure you want to delete ",c.first_name," ",c.last_name,"'s account? This action cannot be undone."]})]}),e.jsxs(be,{children:[e.jsx(Pe,{children:"Cancel"}),e.jsx(De,{onClick:()=>o(c.drivers_id),children:"Delete"})]})]})]}),c.status==="pending"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"default",size:"sm",onClick:()=>i(c.drivers_id),children:"Approve"}),e.jsx(y,{variant:"destructive",size:"sm",onClick:()=>m(c.drivers_id),children:"Reject"})]})]})]})]},c.drivers_id))})})]})}function Us({searchQuery:a,setSearchQuery:n,selectedStatus:t,setSelectedStatus:o,onExport:i}){return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(A,{placeholder:"Search drivers by name, route, or terminal...",value:a,onChange:m=>n(m.target.value),className:"pl-10"})]}),e.jsxs($,{value:t,onValueChange:o,children:[e.jsxs(I,{className:"w-48",children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),e.jsx(U,{})]}),e.jsxs(z,{children:[e.jsx(D,{value:"all",children:"All Status"}),e.jsx(D,{value:"active",children:"Active"}),e.jsx(D,{value:"pending",children:"Pending"}),e.jsx(D,{value:"suspended",children:"Suspended"}),e.jsx(D,{value:"inactive",children:"Inactive"})]})]}),e.jsxs(y,{variant:"outline",onClick:i,children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Export"]})]})}function T({title:a,icon:n,count:t,description:o}){return e.jsxs(W,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:a}),n]}),e.jsxs(K,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o})]})]})}const zs=({currentStep:a,totalSteps:n})=>e.jsx("div",{className:"flex items-center justify-center mb-6",children:Array.from({length:n},(t,o)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${o<=a?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:o+1}),o<n-1&&e.jsx("div",{className:`w-12 h-0.5 mx-2 ${o<a?"bg-primary":"bg-muted"}`})]},o))}),qs=({newDriver:a,setNewDriver:n})=>{const[t,o]=u.useState({}),[i,m]=u.useState({}),c=(r,d)=>{let p="";switch(r){case"firstName":d.trim()?d.trim().length<2&&(p="Name must be at least 2 characters"):p="First name is required";break;case"lastName":d.trim()?d.trim().length<2&&(p="Name must be at least 2 characters"):p="Last name is required";break;case"email":d.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d)||(p="Please enter a valid email address"):p="Email is required";break;case"phone":d.trim()?/^(\+63|0)?[0-9]{10}$/.test(d.replace(/\s+/g,""))||(p="Please enter a valid Philippine phone number"):p="Phone number is required";break;case"password":d?d.length<8?p="Password must be at least 8 characters":/(?=.*[a-zA-Z])(?=.*[0-9])/.test(d)||(p="Password must contain both letters and numbers"):p="Password is required";break;case"confirmPassword":d?d!==a.password&&(p="Passwords do not match"):p="Please confirm your password";break}return p},x=r=>{m({...i,[r]:!0});const d=c(r,a[r]);o({...t,[r]:d})},g=(r,d)=>{if(n({...a,[r]:d}),i[r]){const p=c(r,d);o({...t,[r]:p})}if(r==="password"&&i.confirmPassword){const p=c("confirmPassword",a.confirmPassword);o({...t,[r]:"",confirmPassword:p})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ds,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Personal Information"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"firstName",children:"First Name *"}),e.jsx(A,{id:"firstName",value:a.firstName,onChange:r=>g("firstName",r.target.value),onBlur:()=>x("firstName"),placeholder:"Enter first name",className:t.firstName&&i.firstName?"border-red-500 focus-visible:ring-red-500":""}),t.firstName&&i.firstName&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.firstName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(A,{id:"lastName",value:a.lastName,onChange:r=>g("lastName",r.target.value),onBlur:()=>x("lastName"),placeholder:"Enter last name",className:t.lastName&&i.lastName?"border-red-500 focus-visible:ring-red-500":""}),t.lastName&&i.lastName&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.lastName})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"email",children:"Email Address *"}),e.jsx(A,{id:"email",type:"email",value:a.email,onChange:r=>g("email",r.target.value),onBlur:()=>x("email"),placeholder:"Enter email address",className:t.email&&i.email?"border-red-500 focus-visible:ring-red-500":""}),t.email&&i.email&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.email})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(A,{id:"phone",value:a.phone,onChange:r=>g("phone",r.target.value),onBlur:()=>x("phone"),placeholder:"+63 917 123 4567",className:t.phone&&i.phone?"border-red-500 focus-visible:ring-red-500":""}),t.phone&&i.phone&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.phone})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"password",children:"Password *"}),e.jsx(A,{id:"password",type:"password",value:a.password,onChange:r=>g("password",r.target.value),onBlur:()=>x("password"),placeholder:"Create password",className:t.password&&i.password?"border-red-500 focus-visible:ring-red-500":""}),t.password&&i.password?e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.password})]}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Min. 8 characters with letters and numbers"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"confirmPassword",children:"Confirm Password *"}),e.jsx(A,{id:"confirmPassword",type:"password",value:a.confirmPassword,onChange:r=>g("confirmPassword",r.target.value),onBlur:()=>x("confirmPassword"),placeholder:"Confirm password",className:t.confirmPassword&&i.confirmPassword?"border-red-500 focus-visible:ring-red-500":""}),t.confirmPassword&&i.confirmPassword&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.confirmPassword})]})]})]})},Gs=({newDriver:a,setNewDriver:n})=>{const[t,o]=u.useState({}),[i,m]=u.useState({}),[c,x]=u.useState([]);u.useEffect(()=>{R.get("/routes").then(s=>x(s.data)).catch(s=>console.error(s))},[]);const g=(s,l)=>{let h="";switch(s){case"vehicleType":(!l||l.trim()==="")&&(h="Please select a jeepney type.");break;case"licensePlate":l.trim()?/^[A-Z]{2,3}-?\d{3,4}$/i.test(l.replace(/\s+/g,""))||(h="Invalid license plate format."):h="License plate is required.";break;case"route":(!l||l.trim()==="")&&(h="Please select a route assignment.");break}return h},r=s=>{m({...i,[s]:!0});const l=g(s,a[s]);o({...t,[s]:l})},d=(s,l)=>{if(n({...a,[s]:l}),i[s]){const h=g(s,l);o({...t,[s]:h})}},p=(s,l)=>{n({...a,[s]:l}),m({...i,[s]:!0});const h=g(s,l);o({...t,[s]:h})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ms,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle & Route Details"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"vehicleType",children:"Jeepney Type *"}),e.jsxs($,{value:a.vehicleType,onValueChange:s=>p("vehicleType",s),children:[e.jsx(I,{className:t.vehicleType&&i.vehicleType?"border-red-500 focus:ring-red-500":"",children:e.jsx(U,{placeholder:"Select jeepney type"})}),e.jsxs(z,{children:[e.jsx(D,{value:"modern-jeepney",children:"Modern Jeepney (Electric)"}),e.jsx(D,{value:"euro4-jeepney",children:"Euro 4 Jeepney"}),e.jsx(D,{value:"mini-bus",children:"Mini Bus"})]})]}),t.vehicleType&&i.vehicleType&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.vehicleType})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"licensePlate",children:"License Plate *"}),e.jsx(A,{id:"licensePlate",value:a.licensePlate,onChange:s=>d("licensePlate",s.target.value.toUpperCase()),onBlur:()=>r("licensePlate"),placeholder:"BAC-1234",maxLength:8,className:t.licensePlate&&i.licensePlate?"border-red-500 focus-visible:ring-red-500":""}),t.licensePlate&&i.licensePlate&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.licensePlate})]}),!t.licensePlate&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: ABC-1234 or AB-1234"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"route",children:"Assigned Route *"}),e.jsxs($,{value:a.route,onValueChange:s=>p("route",s),children:[e.jsx(I,{className:t.route&&i.route?"border-red-500 focus:ring-red-500":"",children:e.jsx(U,{placeholder:"Select route assignment"})}),e.jsx(z,{children:c.map(s=>e.jsxs(D,{value:s.id.toString(),children:[s.first_terminal," ↔ ",s.second_terminal]},s.id))})]}),t.route&&i.route&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-red-500",children:[e.jsx(b,{className:"h-3 w-3"}),e.jsx("span",{children:t.route})]})]})]})},Hs=({newDriver:a,setNewDriver:n})=>{const[t,o]=u.useState({}),[i,m]=u.useState({}),c=u.useRef(null),x=u.useRef(null),g=u.useRef(null),r=u.useRef(null),d=h=>["application/pdf","image/jpg","image/jpeg","image/png"].includes(h.type)?h.size>5242880?"File size exceeds the maximum limit of 5MB. Please upload a smaller file.":null:"Invalid file type. Only PDF, JPG, PNG are allowed.",p=(h,j)=>{if(!j)return;const v=d(j);if(v){m({...i,[h]:v});return}const f={...i};delete f[h],m(f);let w;j.type.startsWith("image/")&&(w=URL.createObjectURL(j)),o({...t,[h]:{file:j,preview:w}}),n({...a,documents:{...a.documents,[h]:j}})},s=h=>{const j={...t};j[h]?.preview&&URL.revokeObjectURL(j[h].preview),delete j[h],o(j);const v={...i};delete v[h],m(v);const f={...a.documents};delete f[h],n({...a,documents:f})},l=(h,j,v,f)=>{const w=t[v],N=i[v],L=!!w&&!N;return e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{ref:f,type:"file",accept:".pdf, .jpg, .jpeg, .png",className:"hidden",onChange:B=>p(v,B.target.files?.[0]||null)}),e.jsxs(y,{type:"button",variant:"outline",className:`h-16 w-full flex items-center justify-between gap-3 ${L?"border-green-500 bg-green-50":N?"border-red-500 bg-red-50":""}`,onClick:()=>f.current?.click(),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[L?e.jsx(q,{className:"h-5 w-5 text-green-600"}):N?e.jsx(b,{className:"h-5 w-5 text-red-600"}):e.jsx(ps,{className:"h-5 w-5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:h}),e.jsx("div",{className:"text-xs text-muted-foreground",children:j})]})]}),L&&e.jsx(y,{type:"button",variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:B=>{B.stopPropagation(),s(v)},children:e.jsx(Ie,{className:"h-4 w-4"})})]}),L&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 pl-2",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:w?.file.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",(w.file.size/1024).toFixed(0)," KB)"]})]}),N&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 pl-2",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:N})]})]})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ts,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Required Documents"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload the required documents. You can also upload these later from the driver profile."}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[l("Professional Driver's License","PDF, JPG, PNG (Max 5MB)","driverLicense",c),l("Vehicle Registration (CR/OR)","PDF, JPG, PNG (Max 5MB)","vehicleRegistration",x),l("TPL Insurance","PDF, JPG, PNG (Max 5MB)","insurance",g),l("Franchise Certificate","PDF, JPG, PNG (Max 5MB)","franchise",r)]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," All documents are optional at this stage. You can upload them later, but having complete documentation helps speed up the approval process."]})})]})},Js=({onCreateDriver:a})=>{const[n,t]=u.useState(!1),[o,i]=u.useState(0),[m,c]=u.useState({firstName:"",lastName:"",email:"",phone:"",password:"",confirmPassword:"",vehicleType:"",licensePlate:"",route:""}),x=async s=>{try{const l=new FormData;l.append("first_name",s.firstName),l.append("last_name",s.lastName),l.append("email",s.email),l.append("phone",s.phone),l.append("password",s.password),l.append("password_confirmation",s.confirmPassword),l.append("vehicle_type",s.vehicleType),l.append("license_plate",s.licensePlate),l.append("route_id",s.route),s.documents?.driverLicense&&l.append("driver_license",s.documents.driverLicense),s.documents?.vehicleRegistration&&l.append("vehicle_registration",s.documents.vehicleRegistration),s.documents?.insurance&&l.append("insurance",s.documents.insurance),s.documents?.franchise&&l.append("franchise",s.documents.franchise),await R.post("/operator/driver",l,{headers:{"Content-Type":"multipart/form-data"}}),E.success("Driver Creation Successfully"),a(s),t(!1),i(0)}catch(l){console.error(l),E.error("Error Driver Creation")}},g=()=>{o<2&&i(o+1)},r=()=>{o>0&&i(o-1)},d=s=>{switch(s){case 0:return m.firstName&&m.lastName&&m.email&&m.phone&&m.password&&m.confirmPassword;case 1:return m.vehicleType&&m.licensePlate&&m.route;case 2:return!0;default:return!1}},p=()=>{switch(o){case 0:return e.jsx(qs,{newDriver:m,setNewDriver:c});case 1:return e.jsx(Gs,{newDriver:m,setNewDriver:c});case 2:return e.jsx(Hs,{newDriver:m,setNewDriver:c});default:return null}};return e.jsxs(rs,{open:n,onOpenChange:t,children:[e.jsx(ns,{asChild:!0,children:e.jsxs(y,{children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Add New Driver"]})}),e.jsxs(os,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(ls,{children:[e.jsx(is,{children:"Register New Jeepney Driver"}),e.jsx(cs,{children:"Complete the registration process in 3 simple steps"})]}),e.jsx(zs,{currentStep:o,totalSteps:3}),p(),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("div",{children:o>0&&e.jsxs(y,{variant:"outline",onClick:r,children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Previous"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),o<2?e.jsxs(y,{onClick:g,disabled:!d(o),children:["Next",e.jsx(js,{className:"h-4 w-4 ml-2"})]}):e.jsx(y,{onClick:()=>x(m),children:"Register Driver"})]})]})]})]})};var M={exports:{}},Vs=M.exports,H;function Ws(){return H||(H=1,(function(a,n){(function(t,o){o()})(Vs,function(){function t(r,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}function o(r,d,p){var s=new XMLHttpRequest;s.open("GET",r),s.responseType="blob",s.onload=function(){g(s.response,d,p)},s.onerror=function(){console.error("could not download file")},s.send()}function i(r){var d=new XMLHttpRequest;d.open("HEAD",r,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function m(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(d)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof F=="object"&&F.global===F?F:void 0,x=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!x?function(r,d,p){var s=c.URL||c.webkitURL,l=document.createElement("a");d=d||r.name||"download",l.download=d,l.rel="noopener",typeof r=="string"?(l.href=r,l.origin===location.origin?m(l):i(l.href)?o(r,d,p):m(l,l.target="_blank")):(l.href=s.createObjectURL(r),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){m(l)},0))}:"msSaveOrOpenBlob"in navigator?function(r,d,p){if(d=d||r.name||"download",typeof r!="string")navigator.msSaveOrOpenBlob(t(r,p),d);else if(i(r))o(r,d,p);else{var s=document.createElement("a");s.href=r,s.target="_blank",setTimeout(function(){m(s)})}}:function(r,d,p,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),typeof r=="string")return o(r,d,p);var l=r.type==="application/octet-stream",h=/constructor/i.test(c.HTMLElement)||c.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||l&&h||x)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var N=v.result;N=j?N:N.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=N:location=N,s=null},v.readAsDataURL(r)}else{var f=c.URL||c.webkitURL,w=f.createObjectURL(r);s?s.location=w:location.href=w,s=null,setTimeout(function(){f.revokeObjectURL(w)},4e4)}});c.saveAs=g.saveAs=g,a.exports=g})})(M)),M.exports}var Ys=Ws();const Xs=[{title:"Driver",href:"/driver"}];function _t({drivers:a}){const[n,t]=u.useState(a),[o,i]=u.useState(""),[m,c]=u.useState("all"),x=s=>{const l={active:{variant:"default",color:"bg-green-100 text-green-800"},pending:{variant:"secondary",color:"bg-yellow-100 text-yellow-800"},suspended:{variant:"destructive",color:"bg-red-100 text-red-800"},inactive:{variant:"outline",color:"bg-gray-100 text-gray-800"}};return l[s]||l.inactive},g=s=>{console.log("Create Driver",s)},r=()=>{if(!n||n.length===0)return;const s=n.map(f=>({ID:f.drivers_id,"First Name":f.first_name,"Last Name":f.last_name,Email:f.email,Phone:f.phone||"",Status:f.status,Route:f.route?`${f.route.first_terminal} ↔ ${f.route.second_terminal}`:"","License Plate":f.license_plate,"Vehicle Type":f.vehicle_type||"",Rating:f.rating})),l=O.json_to_sheet(s),h=O.book_new();O.book_append_sheet(h,l,"Drivers");const j=Ke(h,{bookType:"xlsx",type:"array"}),v=new Blob([j],{type:"application/octet-stream"});Ys.saveAs(v,`drivers_export_${new Date().toISOString()}.xlsx`)},d=s=>{s&&(s.deleted?t(l=>l.filter(h=>h.drivers_id!==s.drivers_id)):t(l=>l.map(h=>h.drivers_id===s.drivers_id?s:h)))},p=n.filter(s=>{const l=s.first_name??"",h=s.last_name??"",j=s.email??"",v=s.phone??"",f=(s.status??"").toLowerCase(),w=l.toLowerCase().includes(o.toLowerCase())||h.toLowerCase().includes(o.toLowerCase())||j.toLowerCase().includes(o.toLowerCase())||v.includes(o),N=m==="all"||f===m.toLowerCase();return w&&N});return e.jsxs(Ue,{breadcrumbs:Xs,children:[e.jsx(Se,{title:"Driver Management"}),e.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-primary rounded-xl",children:e.jsx(ee,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx(G,{size:"xl",weight:"bold",children:"Modern Jeepney Driver Management"}),e.jsx(G,{size:"sm",weight:"normal",children:"Manage modernized jeepney drivers in Bacolod City"})]})]}),e.jsx(Js,{onCreateDriver:g})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(T,{title:"Total Jeepney Drivers",icon:e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"}),count:a.length,description:"This includes all registered drivers"}),e.jsx(T,{title:"Active on Routes",icon:e.jsx(q,{className:"h-4 w-4 text-green-500"}),count:a.filter(s=>s.status==="active").length,description:"Operating Routes"}),e.jsx(T,{title:"Pending Approval",icon:e.jsx(us,{className:"h-4 w-4 text-yellow-500"}),count:a.filter(s=>s.status==="pending").length,description:"Awaiting verification"}),e.jsx(T,{title:"Issues",icon:e.jsx(b,{className:"h-4 w-4 text-red-400"}),count:a.filter(s=>s.status==="suspended").length,description:"Need Attention"})]}),e.jsx(Us,{searchQuery:o,setSearchQuery:i,selectedStatus:m,setSelectedStatus:c,onExport:r}),e.jsx(Is,{filteredDrivers:p,getStatusBadge:x,onUpdateDriver:d})]})]})}export{_t as default};
