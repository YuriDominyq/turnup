import{j as e,r as m,a as T,H as D}from"./app-BkWxsPhl.js";import{A as $,T as f}from"./app-layout-v7UnaXSl.js";import{A as L,a as F}from"./alert-C5sJNwoH.js";import{T as I,a as P,b as o}from"./tabs-BhqCRbCR.js";import{C as y,a as B,b as E,d as H,c as V}from"./card-BurzwtvR.js";import{I as U}from"./input-W3PBa2wl.js";import{S as q}from"./search-UMuPKRlf.js";import{B as h}from"./badge-CgNvdETQ.js";import{B as r}from"./app-logo-icon-XumOcAu9.js";import{S as G}from"./separator-NxPAXZ4u.js";import{c as j}from"./createLucideIcon-B4PnhYEd.js";import{C as N}from"./clock-CudoEdBe.js";import{C as Q}from"./circle-check-rPNRxb-6.js";import{U as v}from"./user-CC24J8xB.js";import{P as J}from"./phone-CdREfu6C.js";import{M as K}from"./map-pin-DknOeLZG.js";import{C as O}from"./circle-alert-BTxCwley.js";/* empty css            */import"./index-aRXHSDkN.js";import"./index-1nN5TIoZ.js";import"./chevron-right-DfFKwZIo.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],X=j("Calendar",W);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],p=j("MessageSquare",Y);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],w=j("Navigation",Z);function ee({value:s,onChange:n}){return e.jsxs("div",{className:"mb-6 relative flex-1",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(U,{placeholder:"Search by commuter name, bus number, route, or issue...",value:s,onChange:n,className:"pl-10"})]})}function se({report:s}){const n=l=>{switch(l){case"critical":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}},i=l=>{switch(l){case"new":return"default";case"in-progress":return"secondary";case"resolved":return"outline";default:return"outline"}};return e.jsxs(y,{className:"hover:shadow-lg transition-all hover:scale-[1.01] duration-200",children:[e.jsxs(B,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(h,{variant:n(s.severity),className:"uppercase text-xs font-semibold",children:s.severity}),e.jsxs(h,{variant:i(s.status),className:"text-xs",children:[s.status==="new"&&e.jsx(p,{className:"h-3 w-3 mr-1"}),s.status==="in-progress"&&e.jsx(N,{className:"h-3 w-3 mr-1"}),s.status==="resolved"&&e.jsx(Q,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsx(h,{variant:"outline",className:"text-xs",children:s.category})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground whitespace-nowrap",children:[e.jsx(N,{className:"h-3 w-3"}),e.jsx("span",{children:s.timeAgo})]})]}),e.jsx(E,{className:"text-2xl font-bold mb-2 leading-tight",children:s.subject}),s.description&&e.jsx(H,{className:"text-base leading-relaxed",children:s.description})]}),e.jsxs(V,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-2",children:"Commuter Information"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(v,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s.commuterName})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(J,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.commuterContact})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Trip Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(K,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Route"}),e.jsx("p",{className:"font-medium",children:s.route})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(v,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Driver"}),e.jsx("p",{className:"font-medium",children:s.jeepneyDriver})]})]}),(s.startStop!=="N/A"||s.endStop!=="N/A")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(w,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Start Stop"}),e.jsx("p",{className:"font-medium",children:s.startStop})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(w,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0 rotate-180"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"End Stop"}),e.jsx("p",{className:"font-medium",children:s.endStop})]})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm col-span-full",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Incident Date"}),e.jsx("p",{className:"font-medium",children:s.incidentDate})]})]})]})]}),e.jsx(G,{}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.status==="new"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{size:"sm",className:"flex-1 min-w-[140px]",children:"Assign & Investigate"}),e.jsx(r,{size:"sm",variant:"outline",className:"flex-1 min-w-[140px]",children:"Contact Commuter"}),e.jsx(r,{size:"sm",variant:"ghost",children:"Mark as Invalid"})]}),s.status==="in-progress"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{size:"sm",className:"flex-1 min-w-[140px]",children:"Mark as Resolved"}),e.jsx(r,{size:"sm",variant:"outline",className:"flex-1 min-w-[140px]",children:"Add Update"}),e.jsx(r,{size:"sm",variant:"ghost",children:"View History"})]}),s.status==="resolved"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{size:"sm",variant:"outline",className:"flex-1 min-w-[140px]",children:"View Resolution"}),e.jsx(r,{size:"sm",variant:"ghost",children:"Reopen"})]})]})]})]})}const te=[{title:"Commuter Problems",href:"/problems"}];function be(){const[s,n]=m.useState(""),[i,l]=m.useState([]),[d,C]=m.useState("all");m.useEffect(()=>{T.get("/api/feedback").then(t=>{const u=t.data.map(a=>{const k=a.rating>=4?"high":a.rating===3?"medium":"low",A="new",_=c=>{const M="⭐".repeat(c),R="☆".repeat(5-c);return M+R},z=c=>{switch(c){case 1:return"Poor";case 2:return"Fair";case 3:return"Good";case 4:return"Very Good";case 5:return"Excellent";default:return""}};return{id:a.feedback_id,commuterName:`${a.commuter?.first_name||""} ${a.commuter?.last_name||""}`.trim()||"Unknown",commuterContact:a.commuter?.phone||"N/A",subject:`${_(a.rating)} ${z(a.rating)}`,description:a.comment||"",route:a.ride?.route?`${a.ride.route.first_terminal} - ${a.ride.route.second_terminal}`:"N/A",jeepneyDriver:a.ride?.driver?`${a.ride.driver.first_name} ${a.ride.driver.last_name}`:"N/A",startStop:a.ride?.startStop?.name||"N/A",endStop:a.ride?.endStop?.name||"N/A",incidentDate:new Date(a.created_at).toLocaleString(),severity:k,status:A,category:"Feedback",timeAgo:"Just now"}});l(u)}).catch(t=>{console.error(t)})},[]);const g=(t=>d==="all"?t:t.filter(u=>u.status===d))(i).filter(t=>t.commuterName.toLowerCase().includes(s.toLowerCase())||t.description.toLowerCase().includes(s.toLowerCase())),S=i.filter(t=>t.status==="new").length,x=i.filter(t=>t.severity==="high").length,b=i.filter(t=>t.status==="in-progress").length;return e.jsxs($,{breadcrumbs:te,children:[e.jsx(D,{title:"Commuter Feedbacks"}),e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"p-2.5 bg-primary rounded-xl",children:e.jsx(p,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx(f,{size:"xl",weight:"bold",children:"Commuter Feedbacks"}),e.jsx(f,{size:"sm",weight:"normal",children:"Manage and review feedback submitted by commuters"})]})]}),x>0&&e.jsxs(L,{variant:"destructive",className:"mb-6",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsxs(F,{children:[e.jsxs("strong",{children:[x," critical issue",x>1?"s":""]})," requiring immediate attention"]})]}),e.jsx(ee,{value:s,onChange:t=>n(t.target.value)}),e.jsx(I,{value:d,onValueChange:C,className:"mb-6",children:e.jsxs(P,{children:[e.jsxs(o,{value:"all",children:["All (",i.length,")"]}),e.jsxs(o,{value:"new",children:["New (",S,")"]}),e.jsxs(o,{value:"in-progress",children:["In Progress (",b,")"]}),e.jsx(o,{value:"resolved",children:"Resolved"})]})}),e.jsxs("div",{className:"space-y-4",children:[g.map(t=>e.jsx(se,{report:t},t.id)),g.length===0&&e.jsxs(y,{className:"text-center py-12",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No feedbacks found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters"})]})]})]})]})}export{be as default};
