import{j as e,r as m,a as z,H as D}from"./app-Cexmx4J8.js";import{M as p,a as L,T as g}from"./app-layout-CLyOzKxs.js";import{A as F,a as I}from"./alert-BQCd5K3f.js";import{T as M,a as P,b as o}from"./tabs-239wYK2a.js";import{C as w,a as $,B as h,b as B,d as E,c as H}from"./badge-DJIh0JWC.js";import{I as U}from"./input-P_T3Hd1m.js";import{S as V,P as q}from"./search-BRZMH43I.js";import{B as r}from"./app-logo-icon-BcPeahl4.js";import{S as G}from"./separator-C6wutnbA.js";import{C as f}from"./clock-CtamACcJ.js";import{C as Q}from"./circle-check-CNvOo3NF.js";import{U as N}from"./user-BbP01dfy.js";import{M as J}from"./map-pin-DJidTlNc.js";import{c as K}from"./createLucideIcon-DQobS5Q3.js";import{C as O}from"./calendar-BCKdfuWV.js";import{C as W}from"./circle-alert-Z4oQILFF.js";/* empty css            */import"./index-C55HPdSa.js";import"./index-uExRE54O.js";import"./users-GxbWeFJj.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],v=K("Navigation",X);function Y({value:s,onChange:n}){return e.jsxs("div",{className:"mb-6 relative flex-1",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(U,{placeholder:"Search by commuter name, bus number, route, or issue...",value:s,onChange:n,className:"pl-10"})]})}function Z({report:s}){const n=l=>{switch(l){case"critical":case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}},i=l=>{switch(l){case"new":return"default";case"in-progress":return"secondary";case"resolved":return"outline";default:return"outline"}};return e.jsxs(w,{className:"hover:shadow-lg transition-all hover:scale-[1.01] duration-200",children:[e.jsxs($,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(h,{variant:n(s.severity),className:"uppercase text-xs font-semibold",children:s.severity}),e.jsxs(h,{variant:i(s.status),className:"text-xs",children:[s.status==="new"&&e.jsx(p,{className:"h-3 w-3 mr-1"}),s.status==="in-progress"&&e.jsx(f,{className:"h-3 w-3 mr-1"}),s.status==="resolved"&&e.jsx(Q,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsx(h,{variant:"outline",className:"text-xs",children:s.category})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground whitespace-nowrap",children:[e.jsx(f,{className:"h-3 w-3"}),e.jsx("span",{children:s.timeAgo})]})]}),e.jsx(B,{className:"text-2xl font-bold mb-2 leading-tight",children:s.subject}),s.description&&e.jsx(E,{className:"text-base leading-relaxed",children:s.description})]}),e.jsxs(H,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-2",children:"Commuter Information"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(N,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:s.commuterName})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.commuterContact})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Trip Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(J,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Route"}),e.jsx("p",{className:"font-medium",children:s.route})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(N,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Driver"}),e.jsx("p",{className:"font-medium",children:s.jeepneyDriver})]})]}),(s.startStop!=="N/A"||s.endStop!=="N/A")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(v,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Start Stop"}),e.jsx("p",{className:"font-medium",children:s.startStop})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(v,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0 rotate-180"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"End Stop"}),e.jsx("p",{className:"font-medium",children:s.endStop})]})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm col-span-full",children:[e.jsx(O,{className:"h-4 w-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Incident Date"}),e.jsx("p",{className:"font-medium",children:s.incidentDate})]})]})]})]}),e.jsx(G,{}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.status==="new"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{size:"sm",className:"flex-1 min-w-[140px]",children:"Assign & Investigate"}),e.jsx(r,{size:"sm",variant:"outline",className:"flex-1 min-w-[140px]",children:"Contact Commuter"}),e.jsx(r,{size:"sm",variant:"ghost",children:"Mark as Invalid"})]}),s.status==="in-progress"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{size:"sm",className:"flex-1 min-w-[140px]",children:"Mark as Resolved"}),e.jsx(r,{size:"sm",variant:"outline",className:"flex-1 min-w-[140px]",children:"Add Update"}),e.jsx(r,{size:"sm",variant:"ghost",children:"View History"})]}),s.status==="resolved"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{size:"sm",variant:"outline",className:"flex-1 min-w-[140px]",children:"View Resolution"}),e.jsx(r,{size:"sm",variant:"ghost",children:"Reopen"})]})]})]})]})}const ee=[{title:"Commuter Problems",href:"/problems"}];function Ce(){const[s,n]=m.useState(""),[i,l]=m.useState([]),[d,C]=m.useState("all");m.useEffect(()=>{z.get("/api/feedback").then(t=>{const u=t.data.map(a=>{const S=a.rating>=4?"high":a.rating===3?"medium":"low",k="new",A=c=>{const T="⭐".repeat(c),_="☆".repeat(5-c);return T+_},R=c=>{switch(c){case 1:return"Poor";case 2:return"Fair";case 3:return"Good";case 4:return"Very Good";case 5:return"Excellent";default:return""}};return{id:a.feedback_id,commuterName:`${a.commuter?.first_name||""} ${a.commuter?.last_name||""}`.trim()||"Unknown",commuterContact:a.commuter?.phone||"N/A",subject:`${A(a.rating)} ${R(a.rating)}`,description:a.comment||"",route:a.ride?.route?`${a.ride.route.first_terminal} - ${a.ride.route.second_terminal}`:"N/A",jeepneyDriver:a.ride?.driver?`${a.ride.driver.first_name} ${a.ride.driver.last_name}`:"N/A",startStop:a.ride?.startStop?.name||"N/A",endStop:a.ride?.endStop?.name||"N/A",incidentDate:new Date(a.created_at).toLocaleString(),severity:S,status:k,category:"Feedback",timeAgo:"Just now"}});l(u)}).catch(t=>{console.error(t)})},[]);const j=(t=>d==="all"?t:t.filter(u=>u.status===d))(i).filter(t=>t.commuterName.toLowerCase().includes(s.toLowerCase())||t.description.toLowerCase().includes(s.toLowerCase())),y=i.filter(t=>t.status==="new").length,x=i.filter(t=>t.severity==="high").length,b=i.filter(t=>t.status==="in-progress").length;return e.jsxs(L,{breadcrumbs:ee,children:[e.jsx(D,{title:"Commuter Feedbacks"}),e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"p-2.5 bg-primary rounded-xl",children:e.jsx(p,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx(g,{size:"xl",weight:"bold",children:"Commuter Feedbacks"}),e.jsx(g,{size:"sm",weight:"normal",children:"Manage and review feedback submitted by commuters"})]})]}),x>0&&e.jsxs(F,{variant:"destructive",className:"mb-6",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsxs(I,{children:[e.jsxs("strong",{children:[x," critical issue",x>1?"s":""]})," requiring immediate attention"]})]}),e.jsx(Y,{value:s,onChange:t=>n(t.target.value)}),e.jsx(M,{value:d,onValueChange:C,className:"mb-6",children:e.jsxs(P,{children:[e.jsxs(o,{value:"all",children:["All (",i.length,")"]}),e.jsxs(o,{value:"new",children:["New (",y,")"]}),e.jsxs(o,{value:"in-progress",children:["In Progress (",b,")"]}),e.jsx(o,{value:"resolved",children:"Resolved"})]})}),e.jsxs("div",{className:"space-y-4",children:[j.map(t=>e.jsx(Z,{report:t},t.id)),j.length===0&&e.jsxs(w,{className:"text-center py-12",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No feedbacks found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters"})]})]})]})]})}export{Ce as default};
